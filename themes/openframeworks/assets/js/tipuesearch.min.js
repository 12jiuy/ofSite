function levenshtein(k,u,h,y,v){h=null==h?1:+h;y=null==y?1:+y;v=null==v?1:+v;if(k==u)return 0;var c=k.length,w=u.length;if(0===c)return w*h;if(0===w)return c*v;var l=!1;try{l=!"0"[0]}catch(b){l=!0}l&&(k=k.split(""),u=u.split(""));var l=Array(w+1),x=Array(w+1),q,m,d,p;for(m=0;m<=w;m++)l[m]=m*h;for(q=0;q<c;q++){x[0]=l[0]+v;for(m=0;m<w;m++)d=l[m]+(k[q]==u[m]?0:y),p=l[m+1]+v,p<d&&(d=p),p=x[m]+h,p<d&&(d=p),x[m+1]=d;m=l;l=x;x=m}return d=l[w]}
(function(k){k.fn.tipuesearch=function(u){var h=k.extend({show:7,newWindow:!1,showURL:!0,showTitleCount:!0,minimumLength:3,descriptiveWords:25,highlightTerms:!0,highlightEveryTerm:!1,mode:"static",liveDescription:"*",liveContent:"*",contentLocation:"tipuesearch/tipuesearch_content.json",debug:!1},u);return this.each(function(){function u(c){return decodeURIComponent(((new RegExp("[?|&]"+c+"=([^&;]+?)(&|#|;|$)")).exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function v(q,m){k("#tipue_search_content").hide();
k("#tipue_search_content").html('<div class="tipue_search_spinner"><div class="tipue_search_rect1"></div><div class="tipue_search_rect2"></div><div class="rect3"></div></div>');k("#tipue_search_content").show();var d="",p=!1,b=!1,l=!0,r=0;found=[];var g=k("#tipue_search_input").val().toLowerCase(),g=k.trim(g);if(g.match('^"')&&g.match('"$')||g.match("^'")&&g.match("'$"))l=!1;if(l){for(var n=g.split(" "),g="",a=0;a<n.length;a++){for(var f=!0,e=0;e<tipuesearch_stop_words.length;e++)n[a]==tipuesearch_stop_words[e]&&
(f=!1,b=!0);f&&(g=g+" "+n[a])}g=k.trim(g);n=g.split(" ")}else g=g.substring(1,g.length-1);if(g.length>=h.minimumLength){if(l){if(m){for(var u=g,a=0;a<n.length;a++)for(e=0;e<tipuesearch_replace.words.length;e++)n[a]==tipuesearch_replace.words[e].word&&(g=g.replace(n[a],tipuesearch_replace.words[e].replace_with),p=!0);n=g.split(" ")}b=g;for(a=0;a<n.length;a++)for(e=0;e<tipuesearch_stem.words.length;e++)n[a]==tipuesearch_stem.words[e].word&&(b=b+" "+tipuesearch_stem.words[e].stem);n=b.split(" ");for(a=
0;a<c.pages.length;a++){b=0;l=c.pages[a].text;for(e=0;e<n.length;e++){f=new RegExp(n[e],"gi");if(-1!=c.pages[a].title.search(f)){if(null!==c.pages[a].title.match("^"+f+" "))b+=100;else if(null!==c.pages[a].title.match(" "+f+" "))b+=100;else if(null!==c.pages[a].title.match(" "+f+"$"))b+=100;else var t=c.pages[a].title.match(f).length,b=b+10*t;distance=levenshtein(n[e],c.pages[a].title)+1;b+=1/distance*1E3}h.highlightTerms&&(t=h.highlightEveryTerm?new RegExp("("+n[e]+")","gi"):new RegExp("("+n[e]+
")","i"),l=l.replace(t,'<span class="h01">$1</span>'));if(-1!=c.pages[a].tags.search(f))for(idx in null!==c.pages[a].tags.match("^"+f+" ")?b+=100:null!==c.pages[a].tags.match(" "+f+" ")?b+=100:null!==c.pages[a].tags.match(" "+f+"$")?b+=100:(t=c.pages[a].tags.match(f).length,b+=10*t),tags=c.pages[a].tags.split(" "),tags)-1!=tags[idx].search(f)&&(distance=levenshtein(n[e],tags[idx])+1,b+=1/distance*1E3);-1!=c.pages[a].url.search(f)&&(b+=20);if(0!=b)for(f=0;f<tipuesearch_weight.weight.length;f++)c.pages[a].url==
tipuesearch_weight.weight[f].url&&(b+=tipuesearch_weight.weight[f].score);n[e].match("^-")&&(f=new RegExp(n[e].substring(1),"i"),-1!=c.pages[a].title.search(f)||-1!=c.pages[a].text.search(f)||-1!=c.pages[a].tags.search(f))&&(b=0)}0!=b&&(found.push({score:b,title:c.pages[a].title,desc:l,url:c.pages[a].url}),r++)}}else for(a=0;a<c.pages.length;a++){b=0;l=c.pages[a].text;f=new RegExp(g,"gi");-1!=c.pages[a].title.search(f)&&(null!==c.pages[a].title.match("^"+f+" ")?b+=100:null!==c.pages[a].title.match(" "+
f+" ")?b+=100:null!==c.pages[a].title.match(" "+f+"$")?b+=100:(t=c.pages[a].title.match(f).length,b+=10*t),distance=levenshtein(n[e],c.pages[a].title)+1,b+=1/distance*1E3);-1!=c.pages[a].text.search(f)&&(t=c.pages[a].text.match(f).length,b+=20*t);h.highlightTerms&&(t=h.highlightEveryTerm?new RegExp("("+g+")","gi"):new RegExp("("+g+")","i"),l=l.replace(t,'<span class="h01">$1</span>'));if(-1!=c.pages[a].tags.search(f))for(idx in null!==c.pages[a].tags.match("^"+f+" ")?b+=100:null!==c.pages[a].tags.match(" "+
f+" ")?b+=100:null!==c.pages[a].tags.match(" "+f+"$")?b+=100:(t=c.pages[a].tags.match(f).length,b+=10*t),tags=c.pages[a].tags.split(" "),tags)-1!=tags[idx].search(f)&&(distance=levenshtein(n[e],tags[idx])+1,b+=1/distance*1E3);-1!=c.pages[a].url.search(f)&&(b+=20);if(0!=b)for(f=0;f<tipuesearch_weight.weight.length;f++)c.pages[a].url==tipuesearch_weight.weight[f].url&&(b+=tipuesearch_weight.weight[f].score);0!=b&&(found.push({score:b,title:c.pages[a].title,desc:l,url:c.pages[a].url}),r++)}if(0!=r){h.showTitleCount&&
0==w&&(document.title="("+r+") "+document.title,w++);1==p&&(d+='<div id="tipue_search_warning">'+tipuesearch_string_2+" "+g+". "+tipuesearch_string_3+' <a id="tipue_search_replaced">'+u+"</a></div>");1==r?d+='<div id="tipue_search_results_count">'+tipuesearch_string_4+"</div>":(c_c=r.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),d+='<div id="tipue_search_results_count">'+c_c+" "+tipuesearch_string_5+"</div>");found.sort(function(a,b){return b.score-a.score});for(a=p=0;a<found.length;a++){if(p>=
q&&p<h.show+q&&(d+='<div class="tipue_search_content_title"><a href="'+found[a].url+'"'+x+">"+found[a].title+"</a></div>",h.debug&&(d+='<div class="tipue_search_content_debug">Score: '+found[a].score+"</div>"),h.showURL&&(e=found[a].url.toLowerCase(),0==e.indexOf("http://")&&(e=e.slice(7)),d+='<div class="tipue_search_content_url"><a href="'+found[a].url+'"'+x+">"+e+"</a></div>"),found[a].desc)){e=found[a].desc;g="";n=e.split(" ");if(n.length<h.descriptiveWords)g=e;else for(e=0;e<h.descriptiveWords;e++)g+=
n[e]+" ";g=k.trim(g);"."!=g.charAt(g.length-1)&&(g+=" ...");d+='<div class="tipue_search_content_text">'+g+"</div>"}p++}if(r>h.show){r=Math.ceil(r/h.show);a=q/h.show;d+='<div id="tipue_search_foot"><ul id="tipue_search_foot_boxes">';0<q&&(d+='<li><a class="tipue_search_foot_box" id="'+(q-h.show)+"_"+m+'">'+tipuesearch_string_6+"</a></li>");2>=a?(p=r,3<r&&(p=3),e=0):(p=a+2,p>r&&(p=r),e=a-1);for(;e<p;e++)d=e==a?d+('<li class="current">'+(e+1)+"</li>"):d+('<li><a class="tipue_search_foot_box" id="'+
e*h.show+"_"+m+'">'+(e+1)+"</a></li>");a+1!=r&&(d+='<li><a class="tipue_search_foot_box" id="'+(q+h.show)+"_"+m+'">'+tipuesearch_string_7+"</a></li>");d+="</ul></div>"}}else d+='<div id="tipue_search_warning">'+tipuesearch_string_8+"</div>"}else b?d+='<div id="tipue_search_warning">'+tipuesearch_string_8+". "+tipuesearch_string_9+"</div>":(d+='<div id="tipue_search_warning">'+tipuesearch_string_10+"</div>",d=1==h.minimumLength?d+('<div id="tipue_search_warning">'+tipuesearch_string_11+"</div>"):d+
('<div id="tipue_search_warning">'+tipuesearch_string_12+" "+h.minimumLength+" "+tipuesearch_string_13+"</div>"));k("#tipue_search_content").hide();k("#tipue_search_content").html(d);k("#tipue_search_content").slideDown(200);k("#tipue_search_replaced").click(function(){v(0,!1)});k(".tipue_search_foot_box").click(function(){var a=k(this).attr("id").split("_");v(parseInt(a[0]),a[1])})}var c={pages:[]};k.ajaxSetup({async:!1});var w=0;if("live"==h.mode)for(var l=0;l<tipuesearch_pages.length;l++)k.get(tipuesearch_pages[l]).done(function(q){var m=
k(h.liveContent,q).text(),m=m.replace(/\s+/g," "),d=k(h.liveDescription,q).text(),d=d.replace(/\s+/g," "),p=q.toLowerCase().indexOf("<title>"),b=q.toLowerCase().indexOf("</title>",p+7);q=-1!=p&&-1!=b?q.slice(p+7,b):tipuesearch_string_1;c.pages.push({title:q,text:d,tags:m,url:tipuesearch_pages[l]})});"json"==h.mode&&k.getJSON(h.contentLocation).done(function(h){c=k.extend({},h)});"static"==h.mode&&(c=k.extend({},tipuesearch));var x="";h.newWindow&&(x=' target="_blank"');u("q")&&(k("#tipue_search_input").val(u("q")),
v(0,!0));k(this).keyup(function(c){"13"==c.keyCode&&v(0,!0)})})}})(jQuery);

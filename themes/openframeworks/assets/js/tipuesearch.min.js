(function(l){l.fn.tipuesearch=function(z){var k=l.extend({show:7,newWindow:!1,showURL:!0,showTitleCount:!0,minimumLength:3,descriptiveWords:25,highlightTerms:!0,highlightEveryTerm:!1,mode:"static",liveDescription:"*",liveContent:"*",contentLocation:"tipuesearch/tipuesearch_content.json",debug:!1},z);return this.each(function(){function x(c){return decodeURIComponent(((new RegExp("[?|&]"+c+"=([^&;]+?)(&|#|;|$)")).exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function v(p,t){l("#tipue_search_content").hide();
l("#tipue_search_content").html('<div class="tipue_search_spinner"><div class="tipue_search_rect1"></div><div class="tipue_search_rect2"></div><div class="rect3"></div></div>');l("#tipue_search_content").show();var f="",n=!1,b=!1,r=!0,q=0;found=[];var g=l("#tipue_search_input").val().toLowerCase(),g=l.trim(g);if(g.match('^"')&&g.match('"$')||g.match("^'")&&g.match("'$"))r=!1;if(r){for(var m=g.split(" "),g="",a=0;a<m.length;a++){for(var e=!0,d=0;d<tipuesearch_stop_words.length;d++)m[a]==tipuesearch_stop_words[d]&&
(e=!1,b=!0);e&&(g=g+" "+m[a])}g=l.trim(g);m=g.split(" ")}else g=g.substring(1,g.length-1);if(g.length>=k.minimumLength){if(r){if(t){for(var u=g,a=0;a<m.length;a++)for(d=0;d<tipuesearch_replace.words.length;d++)m[a]==tipuesearch_replace.words[d].word&&(g=g.replace(m[a],tipuesearch_replace.words[d].replace_with),n=!0);m=g.split(" ")}b=g;for(a=0;a<m.length;a++)for(d=0;d<tipuesearch_stem.words.length;d++)m[a]==tipuesearch_stem.words[d].word&&(b=b+" "+tipuesearch_stem.words[d].stem);m=b.split(" ");for(a=
0;a<c.pages.length;a++){b=0;r=c.pages[a].text;for(d=0;d<m.length;d++){e=new RegExp(m[d],"gi");if(-1!=c.pages[a].title.search(e))var h=c.pages[a].title.match(e+" ").length,b=b+200*h,h=c.pages[a].title.match(" "+e).length,b=b+200*h,h=c.pages[a].title.match(e).length,b=b+20*h;-1!=c.pages[a].text.search(e)&&(h=c.pages[a].text.match(e).length,b+=20*h);k.highlightTerms&&(h=k.highlightEveryTerm?new RegExp("("+m[d]+")","gi"):new RegExp("("+m[d]+")","i"),r=r.replace(h,'<span class="h01">$1</span>'));-1!=c.pages[a].tags.search(e)&&
(h=c.pages[a].tags.match(e+" ").length,b+=100*h,h=c.pages[a].tags.match(" "+e).length,b+=100*h,h=c.pages[a].tags.match(e).length,b+=20*h);-1!=c.pages[a].url.search(e)&&(b+=20);if(0!=b)for(e=0;e<tipuesearch_weight.weight.length;e++)c.pages[a].url==tipuesearch_weight.weight[e].url&&(b+=tipuesearch_weight.weight[e].score);m[d].match("^-")&&(e=new RegExp(m[d].substring(1),"i"),-1!=c.pages[a].title.search(e)||-1!=c.pages[a].text.search(e)||-1!=c.pages[a].tags.search(e))&&(b=0)}0!=b&&(found.push({score:b,
title:c.pages[a].title,desc:r,url:c.pages[a].url}),q++)}}else for(a=0;a<c.pages.length;a++){b=0;r=c.pages[a].text;e=new RegExp(g,"gi");-1!=c.pages[a].title.search(e)&&(h=c.pages[a].title.match(e+" ").length,b+=200*h,h=c.pages[a].title.match(" "+e).length,b+=200*h,h=c.pages[a].title.match(e).length,b+=20*h);-1!=c.pages[a].text.search(e)&&(h=c.pages[a].text.match(e).length,b+=20*h);k.highlightTerms&&(h=k.highlightEveryTerm?new RegExp("("+g+")","gi"):new RegExp("("+g+")","i"),r=r.replace(h,'<span class="h01">$1</span>'));
-1!=c.pages[a].tags.search(e)&&(h=c.pages[a].tags.match(e+" ").length,b+=100*h,h=c.pages[a].tags.match(" "+e).length,b+=100*h,h=c.pages[a].tags.match(e).length,b+=20*h);-1!=c.pages[a].url.search(e)&&(b+=20);if(0!=b)for(e=0;e<tipuesearch_weight.weight.length;e++)c.pages[a].url==tipuesearch_weight.weight[e].url&&(b+=tipuesearch_weight.weight[e].score);0!=b&&(found.push({score:b,title:c.pages[a].title,desc:r,url:c.pages[a].url}),q++)}if(0!=q){k.showTitleCount&&0==y&&(document.title="("+q+") "+document.title,
y++);1==n&&(f+='<div id="tipue_search_warning">'+tipuesearch_string_2+" "+g+". "+tipuesearch_string_3+' <a id="tipue_search_replaced">'+u+"</a></div>");1==q?f+='<div id="tipue_search_results_count">'+tipuesearch_string_4+"</div>":(c_c=q.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),f+='<div id="tipue_search_results_count">'+c_c+" "+tipuesearch_string_5+"</div>");found.sort(function(a,b){return b.score-a.score});for(a=n=0;a<found.length;a++){if(n>=p&&n<k.show+p&&(f+='<div class="tipue_search_content_title"><a href="'+
found[a].url+'"'+w+">"+found[a].title+"</a></div>",k.debug&&(f+='<div class="tipue_search_content_debug">Score: '+found[a].score+"</div>"),k.showURL&&(d=found[a].url.toLowerCase(),0==d.indexOf("http://")&&(d=d.slice(7)),f+='<div class="tipue_search_content_url"><a href="'+found[a].url+'"'+w+">"+d+"</a></div>"),found[a].desc)){d=found[a].desc;g="";m=d.split(" ");if(m.length<k.descriptiveWords)g=d;else for(d=0;d<k.descriptiveWords;d++)g+=m[d]+" ";g=l.trim(g);"."!=g.charAt(g.length-1)&&(g+=" ...");f+=
'<div class="tipue_search_content_text">'+g+"</div>"}n++}if(q>k.show){q=Math.ceil(q/k.show);a=p/k.show;f+='<div id="tipue_search_foot"><ul id="tipue_search_foot_boxes">';0<p&&(f+='<li><a class="tipue_search_foot_box" id="'+(p-k.show)+"_"+t+'">'+tipuesearch_string_6+"</a></li>");2>=a?(n=q,3<q&&(n=3),d=0):(n=a+2,n>q&&(n=q),d=a-1);for(;d<n;d++)f=d==a?f+('<li class="current">'+(d+1)+"</li>"):f+('<li><a class="tipue_search_foot_box" id="'+d*k.show+"_"+t+'">'+(d+1)+"</a></li>");a+1!=q&&(f+='<li><a class="tipue_search_foot_box" id="'+
(p+k.show)+"_"+t+'">'+tipuesearch_string_7+"</a></li>");f+="</ul></div>"}}else f+='<div id="tipue_search_warning">'+tipuesearch_string_8+"</div>"}else b?f+='<div id="tipue_search_warning">'+tipuesearch_string_8+". "+tipuesearch_string_9+"</div>":(f+='<div id="tipue_search_warning">'+tipuesearch_string_10+"</div>",f=1==k.minimumLength?f+('<div id="tipue_search_warning">'+tipuesearch_string_11+"</div>"):f+('<div id="tipue_search_warning">'+tipuesearch_string_12+" "+k.minimumLength+" "+tipuesearch_string_13+
"</div>"));l("#tipue_search_content").hide();l("#tipue_search_content").html(f);l("#tipue_search_content").slideDown(200);l("#tipue_search_replaced").click(function(){v(0,!1)});l(".tipue_search_foot_box").click(function(){var a=l(this).attr("id").split("_");v(parseInt(a[0]),a[1])})}var c={pages:[]};l.ajaxSetup({async:!1});var y=0;if("live"==k.mode)for(var u=0;u<tipuesearch_pages.length;u++)l.get(tipuesearch_pages[u]).done(function(p){var t=l(k.liveContent,p).text(),t=t.replace(/\s+/g," "),f=l(k.liveDescription,
p).text(),f=f.replace(/\s+/g," "),n=p.toLowerCase().indexOf("<title>"),b=p.toLowerCase().indexOf("</title>",n+7);p=-1!=n&&-1!=b?p.slice(n+7,b):tipuesearch_string_1;c.pages.push({title:p,text:f,tags:t,url:tipuesearch_pages[u]})});"json"==k.mode&&l.getJSON(k.contentLocation).done(function(k){c=l.extend({},k)});"static"==k.mode&&(c=l.extend({},tipuesearch));var w="";k.newWindow&&(w=' target="_blank"');x("q")&&(l("#tipue_search_input").val(x("q")),v(0,!0));l(this).keyup(function(c){"13"==c.keyCode&&v(0,
!0)})})}})(jQuery);
